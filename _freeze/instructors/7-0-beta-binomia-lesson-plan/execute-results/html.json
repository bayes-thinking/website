{
  "hash": "966ac4b7d18a29df3da32d70ee68f52f",
  "result": {
    "markdown": "---\ntitle: \"Introduction to the Beta-Binomial Model\"\nformat: html\n---\n\n\n**Duration**: 75 minutes\n\n**Learning Objectives**:\n\n-   Understand the Beta-Binomial distribution and its application in Bayesian modeling.\n\n-   Implement the Beta-Binomial model in R.\n\n-   Interpret the results of the model.\n\n-   Gain hands-on experience through practical examples.\n\n**Materials**:\n\n-   R and RStudio installed on participants' computers.\n\n-   Sample dataset (e.g., data on the number of successes and total trials for a series of events).\n\n**Lesson Outline**:\n\n**Introduction** (5 minutes)\n\n-   Briefly recap Bayesian statistics and its advantages.\n\n-   Introduce the Beta-Binomial distribution and its significance in Bayesian modeling.\n\n**Theory and Concepts** (15 minutes)\n\n-   Explain the Beta distribution and its parameters (α and β).\n\n-   Describe how the Beta distribution is used as a prior in Bayesian modeling.\n\n-   Explain the Binomial distribution and its parameters (n and p).\n\n**Practical Implementation** (15 minutes)\n\n-   Load necessary libraries (e.g., *rstan*, *ggplot2*, *dplyr*).\n\n-   Generate a sample dataset (e.g., a hypothetical dataset of success/failure trials).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Sample R Code\n# Load libraries\n# library(rstan)\n# library(ggplot2)\n# library(dplyr)\n# Generate a sample dataset\n# set.seed(123)\n# successes <- c(12, 15, 17, 19, 20)\n# trials <- c(20, 20, 20, 20, 20)\n# data <- data.frame(successes, trials)\n```\n:::\n\n\n-   Define the Beta-Binomial model in Stan, specifying the likelihood and prior distributions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Beta-Binomial model in Stan\n\n#data {\n  #int<lower=0> N;        # Number of observations\n  #int<lower=0> y[N];     # Count data\n  #int<lower=0> n_trials; # Number of trials (constant for a binomial distribution)\n#}\n\n# parameters {\n   #real<lower=0, upper=1> theta;  # Probability parameter\n   #real<lower=0> alpha;           # Beta distribution shape parameter\n   #real<lower=0> beta;            # Beta distribution shape parameter\n#}\n\n#model {\n  # Prior distribution\n # theta ~ beta(alpha, beta);\n\n  # Likelihood\n # y ~ binomial(n_trials, theta);\n#}\n```\n:::\n\n\n-   Compile and fit the model using the **rstan** package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Install and load the rstan package\n#install.packages(\"rstan\")\n#library(rstan)\n\n# Define the data\n#data_list <- list(\n  #N = length(your_data),\n  #y = your_data,\n  #n_trials = number_of_trials\n#)\n\n# Compile the Stan model\n#stan_model <- stan_model(file = \"path/to/your/stan/model/file.stan\")\n\n# Fit the model\n#fit <- sampling(stan_model, data = data_list, chains = 4, iter = 2000, warmup = 1000)\n\n# Print the summary of the posterior distribution\n# print(fit)\n```\n:::\n\n\n**Interpretation of Results** (10 minutes)\n\n-   Explain how to interpret the results of the Beta-Binomial model, including posterior distributions for parameters like theta (probability of success).\n\n-   Visualize the posterior distribution using plots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Sample R Code:\n# Plot posterior distribution of theta\n# posterior_samples <- as.data.frame(fit)\n# ggplot(posterior_samples, aes(x = theta)) +\n# geom_histogram(binwidth = 0.01, fill = \"blue\", color = \"black\") +\n# labs(title = \"Posterior Distribution of Theta\", x = \"Theta (Probability of Success)\") \n```\n:::\n\n\n**Hands-on Practice** (15 minutes)\n\n-   Provide additional datasets for participants to analyze using the Beta-Binomial model.\n\n-   Encourage participants to fit the model, interpret results, and visualize the posterior distribution.\n\n**Q&A and Discussion** (10 minutes)\n\n-   Address any questions or concerns from participants.\n\n-   Discuss real-world applications and extensions of the Beta-Binomial model.\n\n**Conclusion** (5 minutes)\n\n-   Summarize key takeaways from the lesson.\n\n-   Provide resources and references for further learning.\n\n-   Encourage participants to explore more complex Bayesian models and applications.\n\n**Homework Assignment**: Ask participants to analyze a real-world dataset using the Beta-Binomial model in R and share their findings in the next session.\n\n**Assessment**: Evaluate participants' understanding through their ability to implement the Beta-Binomial model, interpret results, and engage in discussions during the lesson.\n\n---------------------------------------------------------------------------------------\n\n**Additional Notes and Resources**\n\n**Explanation of the Beta Binomial Bayesian Model with examples from the Health Sciences**\n\nThe Beta-Binomial Bayesian model is a statistical model used in various fields, including health sciences, to analyze and make inferences about data characterized by the number of successes in a fixed number of trials, where the probability of success can vary. It combines two key distributions: the Beta distribution as a prior for the probability of success and the Binomial distribution to model the observed data. This model is particularly useful in health sciences for a wide range of applications, such as clinical trials, epidemiology, and medical testing. Let's explore the model with a couple of health science examples:\n\n**Some technical notes:**\n\n$$\nY|\\pi \\sim Bin(n, \\pi)\n$$\n\n$$\n\\pi \\sim Beta(\\alpha, \\beta)\n$$\n\n$$\n\\pi |(Y=y) \\sim Beta (\\alpha + y, \\  \\beta +n -y)\n$$\n\n1.  **Prior Model**\n\n    $$\n    f(\\pi)=\\frac{\\Gamma(\\alpha + \\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)}\\pi^{\\alpha - 1}\n    (1-\\alpha)^{\\beta -1}$$\n\n2.  **Data Model**\n\n    $$\n    Bin(n, \\pi)\n    $$\n\n3.  **Likelihood function**\n\n    $$\n    L(\\pi |y)=\\binom {n}{y}\\pi^y\n    (1-\\pi)^{n-y}$$\n\n4.  **Posterior Model**\n\n    $$\n    f(\\pi |y) \\propto f(\\pi)L(\\pi|y) = \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)}\\pi^{\\alpha-1}(1-\\pi)^{\\beta-1}\\binom{n}{y} \\propto \\pi^{(y+\\alpha)-1}(1-\\pi)^{(\\beta +n-y)-1} = Beta(\\alpha +y, \\ \\beta+n-y)\n    $$\n\n**Example 1**: Suppose a pharmaceutical company is conducting a clinical trial to evaluate the success rate of a new drug in treating a specific disease. They enroll 100 patients and record how many of them respond positively to the treatment (successes). In this case, the Beta-Binomial model can be used to estimate the probability of success and its uncertainty.\n\n-   *Beta Distribution as Prior*: The company might have prior beliefs about the success rate of similar drugs and express it using a Beta distribution. For example, they believe that the success rate follows a Beta(10, 10) distribution, which represents a relatively neutral prior with a mean of 0.5.\n\n\n```{=html}\n<!-- -->\n```\n\n-   *Binomial Distribution for Data*: If, out of 100 patients, 60 respond positively to the new drug, the observed data follows a Binomial distribution with parameters n=100 (number of trials) and p (the success rate).\n\nIn this scenario, the Bayesian analysis will update the prior Beta distribution with the observed data, yielding a posterior distribution for the success rate, which provides not only a point estimate but also a credible interval representing the uncertainty around the estimate.\n\n**Example 2**: Epidemiologists want to estimate the prevalence of a rare disease in a population. They decide to conduct a study in which they take a random sample of 500 individuals and test them for the presence of the disease. In this case, the Beta-Binomial model can be used to estimate the prevalence of the disease in the population.\n\n-   *Beta Distribution as Prior*: Epidemiologists might use a Beta(2, 8) distribution as a prior for the prevalence. This implies they have prior knowledge suggesting that the prevalence is low (mean of 0.2) but with some uncertainty.\n\n\n```{=html}\n<!-- -->\n```\n\n-   *Binomial Distribution for Data*: If 10 individuals in the sample test positive for the disease, the observed data follows a Binomial distribution with n=500 (number of trials) and p (prevalence).\n\nIn this scenario, the Bayesian analysis will update the prior Beta distribution with the observed data, resulting in a posterior distribution for the prevalence of the disease. This posterior distribution gives a range of credible estimates for the disease prevalence in the population.\n\nIn both examples, the Beta-Binomial model not only provides a point estimate of the parameter of interest (success rate or disease prevalence) but also quantifies the uncertainty around the estimate, which is a valuable feature in health sciences where decisions can have critical consequences. It allows researchers to make informed decisions, taking both prior beliefs and observed data into account.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}