{
  "hash": "3db6609212db4f717bf86dad1f5d64fb",
  "result": {
    "markdown": "---\ntitle: \"Examples for Normal-Normal\"\nformat: \n  html:\n    embed-resources: true\nexecute:\n  echo: true\n  warning: false\n  message: false\n  error: true\neditor: source  \n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(bayesrules)\nlibrary(tidyverse)\n```\n:::\n\n\n## The Normal Model\n\nRecall the normal model,\n\n$$f(y) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left\\{-\\frac{\\left(y - \\mu\\right)^2}{2\\sigma^2} \\right\\}$$\n\nwhere $y$ is a continuous random variable that can take any value in $\\mathbb{R}$; i.e., $Y \\in \\left(-\\infty, \\infty\\right)$.\n\nSuppose we have $n$ observations, then the joint distribution is given by\n\n$$f(\\overset{\\to}{y}|\\mu) = \\prod_{i=1}^n f(y_i|\\mu) = \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left\\{-\\frac{\\left(y_i - \\mu\\right)^2}{2\\sigma^2} \\right\\}$$\n\nThen the likelihood is given by,\n\n$$\n\\begin{align*}\nL(\\mu| \\overset{\\to}{y}) &\\propto \\prod_{i=1}^n \\exp\\left\\{-\\frac{\\left(y_i - \\mu\\right)^2}{2\\sigma^2} \\right\\} = \\exp\\left\\{-\\frac{\\sum_{i=1}^n \\left(y_i - \\mu\\right)^2}{2\\sigma^2} \\right\\} \\\\\n&\\propto \\exp\\left\\{-\\frac{\\left(\\bar{y} - \\mu\\right)^2}{2\\sigma^2/n} \\right\\} \n\\end{align*}\n$$\n\n## The Normal-Normal Model\n\n- Let $\\mu \\in (-\\infty, \\infty)$ be an unknown mean parameter and $(Y_1, Y_2, ..., Y_n)$ be an independent $N(\\mu, \\sigma^2)$, where $\\sigma$ is assumed to be known.\n\n- The Normal-Normal Bayesian model has Normal distributions for both prior and data. The Normal prior is on the unknown mean, $\\mu$.\n\n$$Y_i | \\mu \\overset{\\text{ind}}{\\sim} N(\\mu, \\sigma^2)$$\n\n$$\\mu \\sim N(\\theta, \\tau^2)$$\n\n- When we have data $\\overset{\\to}{y} = (y_1, ..., y_n)$ with mean $\\bar{y}$, the posterior distribution for $\\mu$ is also Normal with updated parameters,\n\n$$\\mu|\\overset{\\to}{y} \\sim N\\left( \\theta \\frac{\\sigma^2}{n\\tau^2 + \\sigma^2} + \\bar{y} \\frac{n\\tau^2}{n\\tau^2+\\sigma^2}, \\frac{\\tau^2 \\sigma^2}{n\\tau^2 + \\sigma^2} \\right)$$\n\n::: {.panel-tabset}\n\n## Example 1a\n\n- Let’s apply this! Consider analysis of  $\\mu$, the average hippocampal volume among people that have a history of concussions.\n\n- First, let's derive the prior distribution. From the textbook, we can reasonably assume that the hippocampal volumes of our $n=25$ subjects,  $\\overset{\\to}{Y_i} = (y_1, ..., y_n)$, are independent and normally distributed around a mean volume, $\\mu$, with standard deviation $\\sigma$. \n\n- We don’t have prior information about this very specific group, however, Wikipedia tells us that among the general population of human adults, each half of the hippocampus has a volume between 3.0 and 3.5 cm^3^ $\\to$ the total hippocampal volume of both sides of the brain is between 6 and 7 cm^3^.\n\n- Because $\\sigma$ is a nuisance parameter, we’ll assume that the standard deviation is known to be  $\\sigma=0.5$ cm^3^. \n\n- What is the prior distribution in mathematical notation?\n\n- Graph the prior distribution, below:\n\n\n::: {.cell}\n\n:::\n\n\n- Import the `FootballBrain` data from the `Lock5Data` package.\n\n\n::: {.cell}\n\n:::\n\n\n- Only include those that have a history of concussions (*fb_concuss*).\n\n\n::: {.cell}\n\n:::\n\n\n- What is the average hippocampal volume (*volume*) of those that have a history of concussions?\n\n\n::: {.cell}\n\n:::\n\n\n- Construct the density plot for the hippocampal volume (*volume*)\n\n\n::: {.cell}\n\n:::\n\n\n- Does the normal distribution seem reasonable to use here?\n\n- Plot the Normal-Normal model using the `plot_normal_normal()` function from the `bayesrules` package.\n\n\n::: {.cell}\n\n:::\n\n\n- Run the `summarize_normal_normal()` function from the `bayesrules` package.\n\n\n::: {.cell}\n\n:::\n\n\n## Example 1b\n\n- Let's now explore those that did not have prior concussions.\n\n- Re-import the `FootballBrain` data from the `Lock5Data` package.\n\n\n::: {.cell}\n\n:::\n\n\n- Only include those that do not have a history of concussions (*fb_no_concuss*).\n\n\n::: {.cell}\n\n:::\n\n\n- Find the average mean hippocampal volume and sample size of the control subjects who have not been diagnosed with a concussion.\n\n\n::: {.cell}\n\n:::\n\n\n- Find the posterior model of $\\mu$ using `summarize_normal_normal()` from the `bayesrules` package.\n\n\n::: {.cell}\n\n:::\n\n\n- Plot the Normal-Normal model using the `plot_normal_normal()` function from the `bayesrules` package.\n\n\n::: {.cell}\n\n:::\n\n\n\n:::\n\n::: {.panel-tabset}\n\n## Example 2a\n\n- Suppose you just bought stock in Mojo's Bakery. Let $\\mu$ be a random variable that represents the average dollar amount that your stock in Mojo's Bakery goes up or down in a one-day period. \n\n- You believe that $\\mu=8.7$ dollars with a standard deviation of $2.9$ dollars is a reasonable starting point.\n\n- Plot the appropriate Normal prior model for $\\mu$.\n\n\n::: {.cell}\n\n:::\n\n\n- Does it seem plausible that the stock would increase by an average of 9.1 dollars in one day?\n\n- Does it seem plausible that the stock would increase by an average of 5 dollars in one day?\n\n- What is the prior probability that, on average, the stock price *decreases*?\n\n\n::: {.cell}\n\n:::\n\n\n- What is the prior probability that, on average, the stock price increases by more than 9.5 dollars per day?\n\n\n::: {.cell}\n\n:::\n\n\n## Example 2b\n\n- Suppose we assume that the daily changes in Mojo's Bakery stock are normally distributed around an unknown mean of $\\mu$ with a known standard deviation of $\\sigma=2$ dollars.\n\n- On a random sample of 4 days, you observe changes in stock value of --0.6, 1.8, 3.9, and --4.1 dollars.\n\n- Plot the corresponding likelihood function of $\\mu$.\n\n\n::: {.cell}\n\n:::\n\n\n- Plot the Normal-Normal model using the `plot_normal_normal()` function from the `bayesrules` package.\n\n\n::: {.cell}\n\n:::\n\n\n- Use `summarize_normal_normal()` from the `bayesrules` package to calculate descriptive statistics for the prior and posterior models.\n\n\n::: {.cell}\n\n:::\n\n\n- What is the posterior probability that, on average, the stock price goes down?\n\n\n::: {.cell}\n\n:::\n\n\n- What is the posterior probability that, on average, the stock price goes up by more than 9.5 dollars per day?\n\n\n::: {.cell}\n\n:::\n\n\n## Example 2c\n\n- Suppose we assume that the daily changes in Mojo's Bakery stock are normally distributed around an unknown mean of $\\mu$ with a known standard deviation of $\\sigma=1$ dollars.\n\n- On a random sample of 4 days, you observe changes in stock value of --0.6, 1.8, 3.9, and --4.1 dollars.\n\n- Plot the corresponding likelihood function of $\\mu$.\n\n\n::: {.cell}\n\n:::\n\n\n- Plot the Normal-Normal model using the `plot_normal_normal()` function from the `bayesrules` package.\n\n\n::: {.cell}\n\n:::\n\n\n- Use `summarize_normal_normal()` from the `bayesrules` package to calculate descriptive statistics for the prior and posterior models.\n\n\n::: {.cell}\n\n:::\n\n\n- What is the posterior probability that, on average, the stock price goes down?\n\n\n::: {.cell}\n\n:::\n\n\n- What is the posterior probability that, on average, the stock price goes up by more than 9.5 dollars per day?\n\n\n::: {.cell}\n\n:::\n\n\n## Example 2d\n\n- Suppose we assume that the daily changes in Mojo's Bakery stock are normally distributed around an unknown mean of $\\mu$ with a known standard deviation of $\\sigma=3$ dollars.\n\n- On a random sample of 4 days, you observe changes in stock value of --0.6, 1.8, 3.9, and --4.1 dollars.\n\n- Plot the corresponding likelihood function of $\\mu$.\n\n\n::: {.cell}\n\n:::\n\n\n- Plot the Normal-Normal model using the `plot_normal_normal()` function from the `bayesrules` package.\n\n\n::: {.cell}\n\n:::\n\n\n- Use `summarize_normal_normal()` from the `bayesrules` package to calculate descriptive statistics for the prior and posterior models.\n\n\n::: {.cell}\n\n:::\n\n\n- What is the posterior probability that, on average, the stock price goes down?\n\n\n::: {.cell}\n\n:::\n\n\n- What is the posterior probability that, on average, the stock price goes up by more than 9.5 dollars per day?\n\n\n::: {.cell}\n\n:::\n\n\n:::\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}